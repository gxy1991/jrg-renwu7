<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>task28-2</title>
    <style type="text/css">
    *{
      font:25px "Microsoft YaHei";
    }
    #center{
      width: 1000px;
      margin: 0 auto;
    }
    #header{
      background: red;
      height: 50px;
      text-align: center;
      line-height: 50px;
    }
    .part{
      height: 500px;
      margin-top: 20px;
    }
    .part:after{
      content: '';
      display: block;
      clear: both;
    }
    .nav{
      background: yellow;
      height: 50px;
    }
    .aside{
      background: red;
      width: 200px;
      height: 450px;
      float: left;
    }
    .main{
      background: blue;
      width: 700px;
      height: 450px;
      float: right;
    }

    </style>
  </head>
  <body>
    <div id="center">
    <div id='header'>header</div>
      <div class="part">
        <div class="nav">nav1</div>
          <div class="content">
            <div class="aside">aside1</div>
            <div class="main">main1</div>
          </div>
      </div>
      <div class="part">
        <div class="nav">nav2</div>
          <div class="content">
            <div class="aside">aside2</div>
            <div class="main">main2</div>
          </div>
      </div>
      <div class="part">
        <div class="nav">nav3</div>
          <div class="content">
            <div class="aside">aside3</div>
            <div class="main">main3</div>
          </div>
      </div>
      <div class="part">
        <div class="nav">nav4</div>
          <div class="content">
            <div class="aside">aside4</div>
            <div class="main">main4</div>
          </div>
      </div>
    </div>
    <script src='http://code.jquery.com/jquery-latest.js'></script>
    <script type='text/javascript'>
      $.fn.stick=function(){
        var $nav=$(this),
            navW=$nav.width(),
            navH=$nav.height(),
            offsetTop=$nav.offset().top,
            offsetLeft=$nav.offset().left;

      var $navClone = $nav.clone().css({
          'visibility':'hidden',
          'display':'none'
        }).insertBefore($nav);

      $(window).on('scroll',function(){
        var scrollTop=$(this).scrollTop();
        if(scrollTop>=offsetTop){
          if(!isFixed()){
            setFixed();
          }
        }else{
          if(isFixed()){
            unsetFixed();
          }
        }
      })

      function isFixed(){
        return $nav.data('data-fix')
      }

      function setFixed(){
        $nav.data('data-fix',true);
        $nav.css({
          'position':'fixed',
          'top':'0',
          'left':offsetLeft,
          'width':navW,
          'z-index':'50'
        });
        $navClone.show();
      }

      function unsetFixed(){
        $nav.removeAttr('style');
        $navClone.hide();
        $nav.data('data-fix',false);
      }
    }

    $('.nav').each(function(){
      $(this).stick();
    })



    </script>
  </body>
</html>
